# 기능 명세서: 사용자 인증 시스템

**Feature Branch**: `001-user-auth`  
**Created**: 2026-02-05  
**Status**: Draft  
**Input**: 사용자 인증 및 계정 관리 시스템을 구현합니다.

## 사용자 시나리오 및 테스트 *(필수)*

<!--
  중요: 사용자 스토리는 중요도 순으로 우선순위를 지정해야 합니다.
  각 스토리는 독립적으로 테스트 가능해야 하며, 하나만 구현해도 가치를 제공하는 MVP가 되어야 합니다.
-->

### 사용자 스토리 1 - 회원가입 (우선순위: P1)

새로운 사용자가 이메일과 비밀번호를 사용하여 계정을 생성하고 시스템에 접근할 수 있습니다.

**우선순위 이유**: 시스템의 기본 전제 조건입니다. 사용자가 계정을 만들 수 없다면 다른 기능을 사용할 수 없습니다.

**독립 테스트**: 회원가입 양식을 작성하고 제출하여 새 계정이 생성되고 로그인할 수 있는지 확인하여 완전히 테스트할 수 있습니다.

**수락 시나리오**:

1. **Given** 사용자가 회원가입 페이지에 있을 때, **When** 유효한 이메일 주소(예: user@example.com), 강력한 비밀번호(최소 8자, 숫자 및 특수문자 1개 이상), 표시 이름을 입력하고 제출하면, **Then** 계정이 생성되고 사용자가 자동으로 로그인됩니다.

2. **Given** 사용자가 회원가입 양식을 작성할 때, **When** 이미 등록된 이메일 주소를 입력하면, **Then** "이 이메일은 이미 사용 중입니다" 메시지가 표시되고 계정이 생성되지 않습니다.

3. **Given** 사용자가 회원가입 양식을 작성할 때, **When** 약한 비밀번호(예: 7자 이하 또는 숫자/특수문자 없음)를 입력하면, **Then** "비밀번호는 최소 8자이며 숫자와 특수문자를 1개 이상 포함해야 합니다" 메시지가 표시되고 제출이 차단됩니다.

4. **Given** 사용자가 회원가입 양식을 작성할 때, **When** 잘못된 형식의 이메일(예: "notanemail")을 입력하면, **Then** "유효한 이메일 주소를 입력하세요" 메시지가 표시되고 제출이 차단됩니다.

---

### 사용자 스토리 2 - 로그인 및 로그아웃 (우선순위: P1)

등록된 사용자가 자격 증명으로 로그인하고, 활동 중 인증 상태를 유지하며, 원할 때 로그아웃할 수 있습니다.

**우선순위 이유**: 회원가입과 함께 핵심 인증 흐름을 완성합니다. 사용자가 로그인하지 못하면 계정이 무용지물입니다.

**독립 테스트**: 등록된 자격 증명으로 로그인 시도, 인증된 사용자만 볼 수 있는 콘텐츠 접근, 로그아웃하여 완전히 테스트할 수 있습니다.

**수락 시나리오**:

1. **Given** 등록된 사용자가 로그인 페이지에 있을 때, **When** 올바른 이메일과 비밀번호를 입력하고 제출하면, **Then** 사용자가 인증되고 인증된 홈페이지로 리디렉션되며 30일 동안 유효한 세션이 생성됩니다.

2. **Given** 사용자가 로그인 페이지에 있을 때, **When** 잘못된 이메일이나 비밀번호를 입력하면, **Then** "이메일 또는 비밀번호가 올바르지 않습니다" 메시지가 표시되고 접근이 거부됩니다.

3. **Given** 사용자가 로그인되어 있을 때, **When** 시스템과 상호작용(페이지 조회, 작업 수행)하면, **Then** 세션이 자동으로 갱신되어 30일 연장됩니다.

4. **Given** 사용자가 로그인되어 있을 때, **When** 로그아웃 버튼을 클릭하면, **Then** 세션이 무효화되고 사용자가 로그인 페이지로 리디렉션되며 인증된 페이지에 접근할 수 없습니다.

5. **Given** 사용자 세션이 30일 동안 활동이 없을 때, **When** 인증된 페이지에 접근하려고 하면, **Then** 세션이 만료되어 로그인 페이지로 리디렉션됩니다.

---

### 사용자 스토리 3 - 프로필 조회 및 수정 (우선순위: P2)

로그인한 사용자가 자신의 프로필 정보를 조회하고 표시 이름을 업데이트할 수 있습니다.

**우선순위 이유**: 계정 관리의 기본 기능이지만 초기 인증 흐름만큼 중요하지는 않습니다. 사용자가 로그인할 수 있다면 프로필 편집은 나중에 추가할 수 있습니다.

**독립 테스트**: 로그인한 후 프로필 페이지로 이동하고, 현재 정보를 보고, 표시 이름을 변경하고, 업데이트가 지속되는지 확인하여 테스트할 수 있습니다.

**수락 시나리오**:

1. **Given** 사용자가 로그인되어 있을 때, **When** 프로필 페이지로 이동하면, **Then** 현재 표시 이름, 이메일 주소, 가입 일자가 표시됩니다.

2. **Given** 사용자가 프로필 페이지에 있을 때, **When** 표시 이름을 변경하고 저장하면, **Then** 업데이트가 지속되고 "프로필이 성공적으로 업데이트되었습니다" 확인 메시지가 표시됩니다.

3. **Given** 사용자가 프로필 편집 양식에 있을 때, **When** 표시 이름 필드를 비워두고 저장하려고 하면, **Then** "표시 이름은 비워둘 수 없습니다" 메시지가 표시되고 업데이트가 차단됩니다.

4. **Given** 사용자가 프로필 페이지에 있을 때, **When** 이메일 주소를 보면, **Then** 읽기 전용으로 표시되고 변경할 수 없습니다(이메일은 기본 식별자이므로).

---

### 엣지 케이스

- 사용자가 여러 탭에서 동시에 로그인하면 어떻게 됩니까?
  - 모든 탭이 동일한 세션을 공유해야 하며, 한 탭에서 로그아웃하면 모든 탭에서 세션이 무효화되어야 합니다.

- 사용자가 로그인 중 브라우저를 닫고 나중에 돌아오면 어떻게 됩니까?
  - 세션이 30일 내에 만료되지 않았다면 여전히 로그인 상태여야 합니다.

- 사용자가 여러 기기에서 동시에 로그인하면 어떻게 됩니까?
  - 각 기기는 독립적인 세션을 가져야 하며, 한 기기에서 로그아웃해도 다른 기기의 세션에는 영향을 주지 않아야 합니다.

- 사용자가 매우 긴 표시 이름(예: 500자)을 입력하면 어떻게 됩니까?
  - 시스템은 표시 이름 길이를 합리적인 최대값(예: 100자)으로 제한해야 합니다.

- 사용자가 특수문자나 이모지가 포함된 표시 이름을 입력하면 어떻게 됩니까?
  - 시스템은 유니코드 문자를 올바르게 처리하고 저장하며 표시해야 합니다.

- 사용자가 동일한 이메일로 여러 번 연속으로 회원가입을 시도하면 어떻게 됩니까?
  - 첫 번째 성공 후 모든 시도는 "이메일이 이미 사용 중입니다" 메시지로 거부되어야 합니다.

- 사용자가 존재하지 않는 이메일로 로그인을 시도하면 어떻게 됩니까?
  - 보안상 실제 비밀번호가 잘못된 것과 동일한 일반 오류 메시지("이메일 또는 비밀번호가 올바르지 않습니다")를 표시해야 합니다.

## 요구사항 *(필수)*

### 기능 요구사항

**회원가입**

- **FR-001**: 시스템은 이메일 주소, 비밀번호, 표시 이름을 사용하여 사용자가 계정을 만들 수 있어야 합니다.
- **FR-002**: 시스템은 이메일 주소 형식이 유효한지 검증해야 합니다(예: 로컬부분@도메인 형식).
- **FR-003**: 시스템은 비밀번호 강도를 검증해야 합니다: 최소 8자, 숫자 최소 1개, 특수문자 최소 1개 포함.
- **FR-004**: 시스템은 중복된 이메일 주소로 계정 생성을 방지해야 합니다.
- **FR-005**: 시스템은 회원가입 성공 시 사용자를 자동으로 로그인시켜야 합니다.

**인증**

- **FR-006**: 시스템은 이메일과 비밀번호 조합으로 사용자를 인증해야 합니다.
- **FR-007**: 시스템은 잘못된 자격 증명으로 로그인 시도를 거부하고 일반적인 오류 메시지를 표시해야 합니다(보안상 이유로 어느 필드가 잘못되었는지 알려주지 않음).
- **FR-008**: 시스템은 성공적인 인증 시 30일 만료 기간을 가진 세션을 생성해야 합니다.
- **FR-009**: 시스템은 사용자 활동(페이지 조회, 작업)이 있을 때 세션 만료를 30일 더 연장해야 합니다.
- **FR-010**: 시스템은 사용자가 로그아웃할 수 있도록 하여 현재 세션을 즉시 무효화해야 합니다.
- **FR-011**: 시스템은 만료된 세션을 거부하고 사용자에게 다시 로그인하도록 요청해야 합니다.

**프로필 관리**

- **FR-012**: 시스템은 로그인한 사용자가 자신의 프로필 정보(표시 이름, 이메일, 가입 일자)를 조회할 수 있어야 합니다.
- **FR-013**: 시스템은 사용자가 표시 이름을 업데이트할 수 있어야 합니다.
- **FR-014**: 시스템은 표시 이름이 비어 있지 않고 합리적인 길이 제한(최대 100자) 내에 있는지 검증해야 합니다.
- **FR-015**: 시스템은 이메일 주소 변경을 허용하지 않아야 합니다(기본 식별자이므로).
- **FR-016**: 시스템은 유니코드 문자(특수문자, 이모지)를 표시 이름에서 올바르게 처리해야 합니다.

**세션 관리**

- **FR-017**: 시스템은 동일한 사용자가 여러 기기에서 독립적인 세션을 가질 수 있도록 지원해야 합니다.
- **FR-018**: 시스템은 한 기기/탭에서 로그아웃해도 다른 기기의 활성 세션에 영향을 주지 않도록 해야 합니다.

### 주요 엔티티

- **User (사용자)**: 시스템에 등록된 개인을 나타냅니다. 주요 속성: 고유 식별자, 이메일 주소(고유), 비밀번호(암호화 저장), 표시 이름, 가입 일자, 마지막 로그인 일시.

- **Session**: 사용자의 인증 상태를 나타냅니다. 주요 속성: 고유 세션 식별자, 연결된 사용자, 생성 일시, 만료 일시(초기 30일, 활동 시 갱신), 마지막 활동 일시.

## 성공 기준 *(필수)*

### 측정 가능한 결과

- **SC-001**: 사용자는 3분 이내에 회원가입 및 첫 로그인을 완료할 수 있어야 합니다.

- **SC-002**: 잘못된 인증 정보(잘못된 이메일 또는 비밀번호)로 로그인 시도하는 사용자의 100%가 차단되어야 합니다.

- **SC-003**: 활성 사용자의 세션은 30일 동안 활동이 있는 한 중단 없이 유지되어야 합니다.

- **SC-004**: 표시 이름 업데이트는 1초 이내에 완료되고 확인되어야 합니다.

- **SC-005**: 시스템은 동시에 1,000명의 사용자를 성능 저하 없이 지원해야 합니다.

- **SC-006**: 회원가입 시도의 95%가 첫 시도에 성공해야 합니다(유효한 입력이라고 가정).

- **SC-007**: 새 사용자의 90%가 추가 지원 없이 회원가입 및 로그인 프로세스를 완료할 수 있어야 합니다.

---

## 가정사항

- 이메일 주소를 기본 인증 방법 및 고유 식별자로 사용합니다.
- 비밀번호는 암호화되어 저장되며 일반 텍스트로 표시되지 않습니다.
- 세션은 서버 측에서 관리되며 30일 만료 정책을 따릅니다.
- 브라우저 쿠키 또는 유사한 메커니즘을 사용하여 세션을 추적합니다.
- 비밀번호 재설정 기능은 향후 구현 시 이메일 기반 토큰 검증 방식을 사용합니다.
- 사용자 데이터는 업계 표준 데이터 보호 규정을 준수하여 유지됩니다.
- 시스템은 동일한 사용자가 여러 기기에서 동시에 로그인하도록 허용합니다.

---

## 범위 외

다음 기능은 이 명세서의 범위에 포함되지 않으며 향후 업데이트나 별도의 기능으로 고려될 수 있습니다:

- **소셜 로그인**: Google, GitHub, Facebook 등을 통한 OAuth 통합
- **2단계 인증 (2FA)**: SMS, 인증 앱 또는 이메일을 통한 보안 추가 계층
- **비밀번호 재설정**: 이메일 기반 비밀번호 복구 흐름
- **이메일 검증**: 회원가입 중 이메일 소유권 확인
- **계정 비활성화/삭제**: 사용자가 자신의 계정을 비활성화하거나 영구적으로 삭제하는 기능
- **역할 및 권한**: 관리자, 중재자 등 사용자 역할 기반 접근 제어
- **비밀번호 변경**: 로그인한 사용자가 현재 비밀번호를 업데이트하는 기능
- **로그인 시도 제한**: 무차별 대입 공격 방지를 위한 속도 제한
- **세션 관리 UI**: 사용자가 모든 활성 세션을 보고 원격으로 로그아웃하는 기능
